#include "RobloxStuff.h"

prlua_getfield _rlua_getfield;
prlua_setfield rlua_setfield;
prlua_pushnil rlua_pushnil;
prlua_pushvalue rlua_pushvalue;
prlua_pushnumber rlua_pushnumber;
prlua_pushboolean rlua_pushboolean;
prlua_pushlstring rlua_pushlstring;
prlua_call rlua_call;
prlua_pcall rlua_pcall;
prlua_gettop rlua_gettop;
prlua_settop _rlua_settop;

bool RFunc::Initialize()
{
	_rlua_getfield = (prlua_getfield)unprotect(FindPattern(exeName, sigrlua_getfield, 51));
	if (_rlua_getfield == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_getfield function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	rlua_setfield = (prlua_setfield)unprotect(FindPattern(exeName, sigrlua_setfield, 54));
	if (rlua_setfield == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_setfield function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	rlua_pushnil = (prlua_pushnil)unprotect(FindPattern(exeName, sigrlua_pushnil, 12));
	if (rlua_pushnil == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_pushnil function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	rlua_pushvalue = (prlua_pushvalue)unprotect(FindPattern(exeName, sigrlua_pushvalue, 19));
	if (rlua_pushvalue == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_pushvalue function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	rlua_pushnumber = (prlua_pushnumber)unprotect(FindPattern(exeName, sigrlua_pushnumber, 12));
	if (rlua_pushnumber == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_pushnumber function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	rlua_pushboolean = (prlua_pushboolean)unprotect(FindPattern(exeName, sigrlua_pushboolean, 11));
	if (rlua_pushboolean == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_pushboolean function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	rlua_pushlstring = (prlua_pushlstring)unprotect(FindPattern(exeName, sigrlua_pushlstring, 61));
	if (rlua_pushlstring == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_pushlstring function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	rlua_call = (prlua_call)unprotect(FindPattern(exeName, sigrlua_call, 24));
	if (rlua_call == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_call function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	rlua_pcall = (prlua_pcall)unprotect(FindPattern(exeName, sigrlua_pcall, 17));
	if (rlua_pcall == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_pcall function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	rlua_gettop = (prlua_gettop)FindPattern(exeName, sigrlua_gettop, 12);
	if (rlua_gettop == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_gettop function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	_rlua_settop = (prlua_settop)unprotect(FindPattern(exeName, sigrlua_settop, 6));
	if (_rlua_settop == NULL)
	{
		MessageBoxA(NULL, "Unable to get address of rlua_settop function", "Exploit - Error", MB_OK | MB_TOPMOST);
		return FALSE;
	}

	return TRUE;
}
